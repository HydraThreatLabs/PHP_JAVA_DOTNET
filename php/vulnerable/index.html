<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>PHP app — VULNERABLE</title>
  <style>
    body { font-family: system-ui, Arial; margin: 20px; }
    form { margin: 10px 0; }
    input { display:block; margin:6px 0; padding:6px; width:320px; }
    pre { background:#f8f8f8; padding:10px; }
  </style>
</head>
<body>
  <h1>Authentication Demo — VULNERABLE</h1>
  <p>Intentionally vulnerable copy. Comments inside the code explain each weakness.</p>

  <section>
    <h2>Register</h2>
    <form id="regForm">
      <input name="username" placeholder="username">
      <!-- Using type="text" for password to make it obvious in demos -->
      <input name="password" type="text" placeholder="password">
      <button>Register</button>
    </form>
    <pre id="regOut"></pre>
    <!-- NOTE: regOut will be filled with server response -->
  </section>

  <section>
    <h2>Login</h2>
    <form id="logForm">
      <input name="username" placeholder="username">
      <input name="password" type="text" placeholder="password">
      <button>Login</button>
    </form>
    <pre id="logOut"></pre>
  </section>

<script>
/*
  Vulnerable client-side behavior (intentionally insecure):
  1) I insert server response using innerHTML (allows reflected XSS).
  2) I do not sanitize or escape responses from server.
  These two together allow a payload like alert(1) to run if returned by the server.
*/

document.getElementById('regForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  const fd = new FormData(e.target);
  const res = await fetch('api.php?action=register', { method: 'POST', body: fd });
  const text = await res.text();
  // VULNERABLE: inserting server reply as HTML directly
  // If the server echoes unescaped username, and username contains HTML, it will execute in the browser.
  document.getElementById('regOut').innerHTML = text;
});

document.getElementById('logForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  const fd = new FormData(e.target);
  const res = await fetch('api.php?action=login', { method: 'POST', body: fd });
  const text = await res.text();
  // VULNERABLE: same here for login responses
  document.getElementById('logOut').innerHTML = text;
});
</script>
</body>
</html>
