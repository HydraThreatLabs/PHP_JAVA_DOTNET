<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>PHP App SAFE</title>
<style>
body { font-family: system-ui, Arial; margin:20px; }
form { margin:10px 0; }
input { display:block; margin:6px 0; padding:6px; width:320px; }
pre { background:#f4f4f4; padding:10px; white-space:pre-wrap; }
.hidden { display:none; }
nav button { margin-right:8px; padding:6px 10px; }
</style>
</head>
<body>
<h1>Authentication Demo â€” SAFE</h1>

<nav>
<button id="btn-reg">Show Registration</button>
<button id="btn-log">Show Login</button>
</nav>

<section id="reg" class="hidden">
<h2>Register</h2>
<form id="regForm">
<input name="username" placeholder="Username (3-50 chars)" required minlength="3" maxlength="50">
<input name="password" type="password" placeholder="Password (min 6 chars)" required minlength="6" maxlength="200">
<button>Register</button>
</form>
<pre id="regOut"></pre>
</section>

<section id="log" class="hidden">
<h2>Log in</h2>
<form id="logForm">
<input name="username" placeholder="Username" required>
<input name="password" type="password" placeholder="Password" required>
<button>Login</button>
</form>
<pre id="logOut"></pre>
</section>

<script>
const reg=document.getElementById('reg'),log=document.getElementById('log');
document.getElementById('btn-reg').addEventListener('click',()=>{reg.classList.remove('hidden');log.classList.add('hidden');});
document.getElementById('btn-log').addEventListener('click',()=>{log.classList.remove('hidden');reg.classList.add('hidden');});

async function postAction(action,form,outEl){
  outEl.textContent='Please wait...';
  const fd=new FormData(form);
  try{
    const res=await fetch('api.php?action='+encodeURIComponent(action),{method:'POST',body:fd});
    const text=await res.text();
    outEl.textContent=text;
    if(action==='login' && res.ok) alert('You have been logged in (SAFE)');
  }catch(e){outEl.textContent='Network error: '+e.message;}
}

document.getElementById('regForm').addEventListener('submit',e=>{e.preventDefault();postAction('register',e.target,document.getElementById('regOut'));});
document.getElementById('logForm').addEventListener('submit',e=>{e.preventDefault();postAction('login',e.target,document.getElementById('logOut'));});
</script>
</body>
</html>
